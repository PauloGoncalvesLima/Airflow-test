stages:
  - tests
  - lint

default:
  image: python:3.10-slim
  retry: 0
  before_script:
    - pip install -r requirements.txt  # Install dependencies
    - pip install -r requirements.testing.txt  # Install testing dependencies

lint-ruff:
  stage: lint
  script:
    - pip install ruff
    - ruff .

lint-black:
  stage: lint
  script:
    - pip install black
    - black . --check --verbose --color

.default_pytest: &default_pytest
  script:
    - pytest .
  coverage: '/^TOTAL.+?(\d+\%)$/'


pytest-3.8:
  stage: tests
  image: python:3.8-slim
  <<: *default_pytest

pytest-3.9:
  stage: tests
  image: python:3.9-slim
  <<: *default_pytest

pytest-3.10:
  stage: tests
  image: python:3.10-slim
  <<: *default_pytest

pytest-3.11:
  stage: tests
  image: python:3.11-slim
  <<: *default_pytest
